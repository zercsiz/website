{% extends 'base.html' %}

{% block content %}
    <head>
        <title>جزعیات</title>
    </head>
<div class="container-fluid mt-3 p-0">
{#    teacher information#}
    <div class="d-flex flex-column">
        <div class="row">
            <div class="col-2">
                <div class="card" style="height: 200px; width: 200px">

                </div>
            </div>
            <div class="col m-auto">
                <h5>{{ teacher.first_name }} {{ teacher.last_name }}</h5>
                <small>{{ teacher.skill }}</small>
                <p>{{ teacher.description }}</p>
            </div>
        </div>
    </div>
    <hr>
</div>
    <div class="container">
        {% if plan_times %}
            <form id="sectionForm"action="" method="post">
                {% csrf_token %}
                <h5 class="text-center m-2">زمان های قابل رزرو</h5>
                <table class="table table-bordered table-striped-columns my-4">
                    <tbody>
                        {% for w_day in week_days %}
                            <tr>
                                <th scope="row" style="width: 100px">{{ w_day }}</th>
                                {% for p_time in plan_times %}
                                    {% if p_time.week_day == w_day %}
                                        <td class="text-center table-primary"><input class="form-check-input border border-dark mx-2" type="checkbox" value="{{ p_time.id }}" id="{{ p_time.id }}" name="p_time_id">{{ p_time.start|date:"H:i" }}-{{ p_time.end|date:"H:i" }}</td>
                                    {% endif %}
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <div class="d-flex justify-content-center">
                    <div class="row justify-content-center gap-3">
                        <lable class="col-lg-3 text-center align-self-center" for="start_date">تاریخ شروع جلسات</lable>
                        <input class="col-lg-2 form-control" id="start_date" name="start_date" type="date" placeholder="تاریخ شروع جلسات" style="width: 300px">
                        <input class="col-2 form-control" name="session_number" type="number" placeholder="تعداد جلسات" style="width: 300px; height: 50px" required="True">
                        <p class="text-center">اگر تاریخ شروع جلسات را خالی بگذارید، جلسات شما از زودترین تاریخ ممکن آغاز خواهند شد.</p>
                        <button class="btn btn-primary my-3" type="submit" style=" width: 200px; height: 50px">افزودن به سبد رزرو</button>
                    </div>
                </div>
            </form>
            {% else %}
            <p class="text-center m-2">هنوز برنامه ای اعلام نشده است.</p>
        {% endif %}
    </div>
    <script>
        (function() {
            const form = document.querySelector('#sectionForm');
            const checkboxes = form.querySelectorAll('input[type=checkbox]');
            const checkboxLength = checkboxes.length;
            const firstCheckbox = checkboxLength > 0 ? checkboxes[0] : null;

            function init() {
                if (firstCheckbox) {
                    for (let i = 0; i < checkboxLength; i++) {
                        checkboxes[i].addEventListener('change', checkValidity);
                    }

                    checkValidity();
                }
            }

            function isChecked() {
                for (let i = 0; i < checkboxLength; i++) {
                    if (checkboxes[i].checked) return true;
                }

                return false;
            }

            function checkValidity() {
                const errorMessage = !isChecked() ? 'At least one checkbox must be selected.' : '';
                firstCheckbox.setCustomValidity(errorMessage);
            }

            init();
        })();
    </script>
{% endblock %}